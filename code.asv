% Background estimation by least square 

% reading the image angiography as double
img = im2double(imread("angiography_live_image.tif"));
[r0,c0] = size(input_matrix);

% Finding coefficients for second degree polynomial
% surface fitting
z_est = PolynomialSurfaceFitting(img); 

% Recreating the image according the estimated Z
est_image = zeros(r0,c0);
b = 1;
for i=1:r0
    for j=1:c0
        est_image(i,j) = z_est(b,1);       
        b = b+1;        
    end
end
imshow(est_image)